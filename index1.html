<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meal Finder</title>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #f8f8f8;
      }
      .icon-img {
        width: 30px;
        height: 30px;
      }
      .menu-icon {
        padding-right: 50px;
        width: 25px;
        height: 25px;
        cursor: pointer;
      }
      header {
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 1000;
        background-color: #ff6f00;
        color: white;
        padding: 30px;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
      .header-icon {
        display: flex;
        flex-direction: row;
      }
      header h1 {
        margin: 0;
        font-size: 1.5em;
      }
      header h1 a {
        text-decoration: none;
        color: white;
      }
      .banner {
        background-color: rgba(0, 0, 0, 0.3);
        color: white;
        height: 300px;
        text-align: center;
        padding: 50px 20px;
        position: relative;
        overflow: hidden;
        z-index: 1;
      }
      .banner::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
          url("./accessts/images/background.jpeg") no-repeat center/cover;
        filter: blur(3px);
      }
      .anime {
        width: 90px;
        height: 90px;
        animation: chef 10s ease-in-out infinite normal;
      }
      @keyframes chef {
        0% {
          transform: translate(-100px, 0);
        }
        25% {
          transform: translate(100px, 0);
        }
        50% {
          transform: translate(-100px, 0);
        }
        75% {
          transform: translate(100px, 0);
        }
        100% {
          transform: translate(-100px, 0);
        }
      }
      .search-container {
        position: absolute;
        top: 40%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40%;
        max-width: 600px;
      }
      .search-input {
        width: 80%;
        padding: 10px;
        border-radius: 20px;
        border: none;
        font-size: 1em;
      }
      .search-button {
        background-color: #ff6f00;
        border: none;
        border-radius: 50%;
        padding: 10px;
        cursor: pointer;
        margin-left: -40px;
      }
      .banner-text {
        margin-top: 200px;
        color: white;
      }
      .categories-section,
      .meals-section {
        padding: 20px;
      }
      .banner-text2 {
        color: white;
        font-size: 35px;
      }
      h2 {
        color: black;
        padding-bottom: 10px;
        font-size: 20px;
      }
      .category-grid,
      .meal-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
      }
      .card {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        text-align: center;
        cursor: pointer;
        position: relative;
      }
      .card img {
        width: 100%;
        height: auto;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
      }
      .card-label {
        background: #ff6f00;
        color: white;
        padding: 5px 10px;
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        border-radius: 4px;
        font-size: 0.9em;
      }
      .meal-card {
        text-align: left;
        padding: 10px;
      }
      .meal-tag {
        background: #ff6f00;
        color: white;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.8em;
      }
      #meal-details {
        padding: 20px;
        display: none;
      }
      #category-details {
        padding: 20px;
        display: none;
      }
      .ingredients-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 10px;
      }
      .ingredient {
        background: #ff6f00;
        color: white;
        padding: 5px;
        border-radius: 50%;
        text-align: center;
      }
      .measures {
        margin-top: 20px;
      }
      .back-button {
        background: #ff6f00;
        color: white;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        margin-bottom: 20px;
      }
      /* Sidebar for categories */
      .sidebar {
        position: fixed;
        right: -300px; /* Start off-screen */
        top: 100px;
        width: 250px;
        background: white;
        padding: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: right 0.3s ease-in-out;
        height: calc(100vh - 100px);
        overflow-y: auto;
        z-index: 1000;
      }
      .sidebar.active {
        right: 0; /* Slide in fully */
      }
      .sidebar ul {
        list-style: none;
        padding: 0;
      }
      .sidebar li {
        margin-bottom: 10px;
        cursor: pointer;
      }
      /* Hide sidebar on small screens by default, show on toggle */
      @media (max-width: 767px) {
        .sidebar {
          display: none;
        }
        .sidebar.active {
          display: block;
        }
      }
      /* On larger screens, sidebar is visible by default but can still toggle */
      @media (min-width: 768px) {
        .sidebar {
          display: block;
          right: -350px; /* Off-screen by default */
        }
        .sidebar.active {
          right: 20px; /* Slide in to a fixed position */
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-icon">
        <img src="./accessts/icons/cutlery.png" alt="icon" class="icon-img" />
        <h1>
          <a href="index.html">MEAL FINDER</a>
        </h1>
      </div>
      <img src="./accessts/icons/menu.png" alt="menu-icon" class="menu-icon" />
    </header>
    <div class="banner">
      <div class="search-container">
        <div>
          <img src="./accessts/images/cat-removebg-preview.png" class="anime" />
        </div>
        <input
          type="text"
          id="search-input"
          class="search-input"
          placeholder="Search recipes here..."
        />
        <button class="search-button">üîç</button>
      </div>
      <div class="banner-text">
        <h2 class="banner-text2">What are your favorite cuisines?</h2>
        <p>PERSONALIZE YOUR EXPERIENCE</p>
      </div>
    </div>
    <div class="sidebar">
      <ul id="sidebar-categories"></ul>
    </div>
    <section id="home" class="categories-section">
      <h2>CATEGORIES</h2>
      <div class="category-grid" id="category-grid"></div>
    </section>
    <section id="search-results" class="meals-section" style="display: none">
      <h2>MEALS</h2>
      <div class="meal-grid" id="search-grid"></div>
    </section>
    <section id="category-details" style="display: none">
      <button class="back-button" onclick="backToHome()">Back</button>
      <h2 id="category-title"></h2>
      <p id="category-description"></p>
      <h3>MEALS</h3>
      <div class="meal-grid" id="category-meal-grid"></div>
    </section>
    <section id="meal-details" style="display: none">
      <button class="back-button" onclick="backFromDetails()">Back</button>
      <h2 id="meal-title"></h2>
      <img
        id="meal-image"
        src=""
        alt="Meal Image"
        style="width: 100%; max-width: 400px"
      />
      <p>Category: <span id="meal-category"></span></p>
      <p>Source: <a id="meal-source" href=""></a></p>
      <p>Tags: <span id="meal-tags"></span></p>
      <h3>Ingredients</h3>
      <div class="ingredients-list" id="ingredients-list"></div>
      <h3>Measures</h3>
      <ul id="measures-list"></ul>
      <h3>Instructions</h3>
      <p id="meal-instructions"></p>
    </section>
    <script>
      const API_BASE = "https://www.themealdb.com/api/json/v1/1/";
      let previousView = "home";

      // Fetch and render categories on load
      async function loadCategories() {
        const res = await fetch(`${API_BASE}categories.php`);
        const data = await res.json();
        const categories = data.categories;

        const grid = document.getElementById("category-grid");
        grid.innerHTML = "";
        const sidebarList = document.getElementById("sidebar-categories");
        sidebarList.innerHTML = "";

        categories.forEach((cat) => {
          const card = document.createElement("div");
          card.classList.add("card");
          card.innerHTML = `
                    <img src="${cat.strCategoryThumb}" alt="${cat.strCategory}">
                    <div class="card-label">${cat.strCategory.toUpperCase()}</div>
                `;
          card.onclick = () =>
            showCategoryDetails(cat.strCategory, cat.strCategoryDescription);
          grid.appendChild(card);

          const li = document.createElement("li");
          li.textContent = cat.strCategory;
          li.onclick = () =>
            showCategoryDetails(cat.strCategory, cat.strCategoryDescription);
          sidebarList.appendChild(li);
        });

        // Add click event to menu icon to toggle sidebar
        const menuIcon = document.querySelector(".menu-icon");
        const sidebar = document.querySelector(".sidebar");
        menuIcon.addEventListener("click", () => {
          sidebar.classList.toggle("active");
        });
      }

      // Show category details
      async function showCategoryDetails(category, description) {
        document.getElementById("home").style.display = "none";
        document.getElementById("search-results").style.display = "none";
        const catDetails = document.getElementById("category-details");
        catDetails.style.display = "block";

        document.getElementById("category-title").textContent = category;
        document.getElementById("category-description").textContent =
          description;

        const res = await fetch(`${API_BASE}filter.php?c=${category}`);
        const data = await res.json();
        const meals = data.meals || [];

        const grid = document.getElementById("category-meal-grid");
        grid.innerHTML = "";

        meals.forEach((meal) => {
          const card = document.createElement("div");
          card.classList.add("card", "meal-card");
          card.innerHTML = `
                    <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
                    <p>${meal.strMeal}</p>
                `;
          card.onclick = () => showMealDetails(meal.idMeal, "category");
          grid.appendChild(card);
        });

        previousView = "category";
      }

      // Search functionality
      document.querySelector(".search-button").onclick = async () => {
        const query = document.getElementById("search-input").value.trim();
        if (!query) return;

        document.getElementById("home").style.display = "none";
        document.getElementById("category-details").style.display = "none";
        const searchResults = document.getElementById("search-results");
        searchResults.style.display = "block";

        const res = await fetch(`${API_BASE}search.php?s=${query}`);
        const data = await res.json();
        const meals = data.meals || [];

        const grid = document.getElementById("search-grid");
        grid.innerHTML = "";

        meals.forEach((meal) => {
          const card = document.createElement("div");
          card.classList.add("card", "meal-card");
          card.innerHTML = `
                    <span class="meal-tag">${meal.strCategory}</span>
                    <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
                    <p>${meal.strArea}</p>
                    <p>${meal.strMeal}</p>
                `;
          card.onclick = () => showFullMealDetails(meal);
          grid.appendChild(card);
        });

        previousView = "search";
      };

      // Show meal details from ID (for category lists)
      async function showMealDetails(id, from) {
        const res = await fetch(`${API_BASE}lookup.php?i=${id}`);
        const data = await res.json();
        const meal = data.meals[0];
        showFullMealDetails(meal);
        previousView = from;
      }

      // Show full meal details
      function showFullMealDetails(meal) {
        document.getElementById("home").style.display = "none";
        document.getElementById("search-results").style.display = "none";
        document.getElementById("category-details").style.display = "none";
        const details = document.getElementById("meal-details");
        details.style.display = "block";

        document.getElementById("meal-title").textContent = meal.strMeal;
        document.getElementById("meal-image").src = meal.strMealThumb;
        document.getElementById("meal-category").textContent = meal.strCategory;
        document.getElementById("meal-source").href = meal.strSource;
        document.getElementById("meal-source").textContent = meal.strSource;
        document.getElementById("meal-tags").textContent =
          meal.strTags || "None";
        document.getElementById("meal-instructions").textContent =
          meal.strInstructions;

        const ingList = document.getElementById("ingredients-list");
        ingList.innerHTML = "";
        for (let i = 1; i <= 20; i++) {
          if (meal[`strIngredient${i}`]) {
            const ing = document.createElement("div");
            ing.classList.add("ingredient");
            ing.textContent = meal[`strIngredient${i}`];
            ingList.appendChild(ing);
          }
        }

        const measList = document.getElementById("measures-list");
        measList.innerHTML = "";
        for (let i = 1; i <= 20; i++) {
          if (meal[`strMeasure${i}`]) {
            const li = document.createElement("li");
            li.textContent = meal[`strMeasure${i}`];
            measList.appendChild(li);
          }
        }
      }

      // Back to home
      function backToHome() {
        document.getElementById("category-details").style.display = "none";
        document.getElementById("search-results").style.display = "none";
        document.getElementById("meal-details").style.display = "none";
        document.getElementById("home").style.display = "block";
      }

      // Back from details
      function backFromDetails() {
        document.getElementById("meal-details").style.display = "none";
        if (previousView === "category") {
          document.getElementById("category-details").style.display = "block";
        } else if (previousView === "search") {
          document.getElementById("search-results").style.display = "block";
        } else {
          backToHome();
        }
      }

      // Load on start
      loadCategories();
    </script>
  </body>
</html>
